<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Guided Exercise: Guided solution :: Live migration of virtual machine using web console</title>
    <link rel="prev" href="section5.html">
    <link rel="next" href="../appendix/appendix.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Live migration of virtual machine using web console</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/migrationvm-webconsole/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="MigratonVM-webconsole" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat Enterprise Linux: Live migration of virtual machine using web console</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Live migrating a virtual machine using the web console.</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">What is virtualization?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">What is live migration of a virtual machine?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">What is the purpose of live migration?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section4.html">What is the lab setup in the exercise?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.html">What are the considerations for a successful live migration?</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section6.html">Guided Exercise: Guided solution</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat Enterprise Linux: Live migration of virtual machine using web console</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat Enterprise Linux: Live migration of virtual machine using web console</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat Enterprise Linux: Live migration of virtual machine using web console</a></li>
    <li><a href="index.html">Live migrating a virtual machine using the web console.</a></li>
    <li><a href="section6.html">Guided Exercise: Guided solution</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Guided Exercise: Guided solution</h1>
<div class="paragraph">
<p>Create a virtual machine and live migrate it using the web console.</p>
</div>
<div class="paragraph">
<p><strong>Outcomes</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Live-migrate a virtual machine (VM) from servera to serverb.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As the <code>student</code> user on the <code>workstation</code> machine, use the lab command to prepare your environment for this exercise, and to ensure that all required resources are available.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ lab start migration-cockpit</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Instructions</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure shared storage for <code>servera</code> and <code>serverb</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Verify the NFS export on the <code>workstation</code> machine. The workstation machine is configured as a NFS server by the <code>lab start</code> command you ran in the preceding step.</p>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ sudo exportfs
[sudo] password for student:
/mnt          	&lt;world&gt;</pre>
</div>
</div>
</li>
<li>
<p>Open a new terminal to <code>workstation</code> and log in to <code>servera</code>. Mount the shared directory on the source machine (<code>servera</code>).</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Use the sudo password <code>student</code> whenever required.</p>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ ssh servera
[student@servera ~]$ sudo -i
[sudo] password for student:
[root@servera ~]# mount workstation:/mnt /mnt
[root@servera ~]# mount | grep workstation
workstation:/mnt on /mnt type nfs4 ...</pre>
</div>
</div>
</li>
<li>
<p>The last command verifies that the mount is successful.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Open a new terminal to <code>workstation</code> and log in to <code>serverb</code>. Mount the shared directory on the destination machine (<code>serverb</code>).</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Use the sudo password <code>student</code> whenever required.</p>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ ssh serverb
[student@serverb ~]$ sudo -i
[sudo] password for student:
[root@serverb ~]# mount workstation:/mnt /mnt
[root@serverb ~]# mount | grep workstation
workstation:/mnt on /mnt type nfs4 ...</pre>
</div>
</div>
</li>
<li>
<p>The last command verifies that the mount is successful.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add secondary hosts on the RHEL web console</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Switch to the <code>workstation</code> terminal and enable the service for the RHEL web console.</p>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ sudo -i
[sudo] password for student:
[root@workstion ~]# systemctl enable --now cockpit.socket</pre>
</div>
</div>
</li>
<li>
<p>Visit the GNOME login screen on the <code>workstation</code> machine. Click the <code>student</code> user account. Enter student when prompted for the password.</p>
</li>
<li>
<p>Navigate to <code><a href="https://localhost:9090" class="bare">https://localhost:9090</a></code> to access the RHEL web console on the Firefox browser.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.3.png" alt="2.3">
</div>
</div>
</li>
<li>
<p>Proceed with the self-signed certificate by clicking on <strong>Advanced&#8230;&#8203;</strong> and <strong>Accept the Risk and Continue</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.4.png" alt="2.4">
</div>
</div>
</li>
<li>
<p>Log in by using the username <code>student</code> and by entering the <code>student</code> password.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.5.png" alt="2.5">
</div>
</div>
</li>
<li>
<p>Click <strong>Turn on administrative access</strong>. Enter the password student when prompted and click <strong>Authenticate</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.6.png" alt="2.6">
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>You have now switched to administrative access on the primary host.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add <code>servera</code> as a secondary host.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Expand the hidden Hosts menu by clicking the down-arrow in the left pane. The image displays the host menu section.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.7.1.png" alt="2.7.1">
</div>
</div>
</li>
<li>
<p>In the <strong>Host menu</strong>, select <strong>Add new host</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.7.2.png" alt="2.7.2">
</div>
</div>
</li>
<li>
<p>The Add new host dialog appears.</p>
</li>
<li>
<p>In the Add new host dialog, configure the following properties and <strong>click Add</strong>.</p>
<div class="literalblock">
<div class="content">
<pre>Host: servera
User name: student</pre>
</div>
</div>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.7.3.png" alt="2.7.3">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add <code>serverb</code> as another secondary host in the similar way.</p>
<div class="literalblock">
<div class="content">
<pre>Host: serverb
User name: student</pre>
</div>
</div>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.8.png" alt="2.8">
</div>
</div>
</li>
<li>
<p>Verify both <code>servera</code> and <code>serverb</code> got added successfully by <strong>clicking on their names</strong> in the left pane. You can see details of <code>servera</code> and <code>serverb</code> after clicking on them.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/2.9.png" alt="2.9">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create a storage volume on servera.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Switch to <code>servera</code> by clicking the down-arrow in the left pane and click <code>servera</code>.</p>
</li>
<li>
<p>Click <strong>Turn on administrative access</strong> on <code>servera</code>. Enter the password <code>student</code> when prompted and click <strong>Authenticate</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/3.2.png" alt="3.2">
</div>
</div>
</li>
<li>
<p>Switch to the <strong>terminal</strong> to start and enable the <strong>libvirtd</strong> service on <code>servera</code> and <code>serverb</code>.</p>
<div class="literalblock">
<div class="content">
<pre>[root@servera ~]# systemctl enable --now libvirtd
Created symlink /etc/systemd/system/multi-user.target.wants/libvirtd.service → /usr/lib/systemd/system/libvirtd.service.
...output omitted...</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# systemctl enable --now libvirtd
Created symlink /etc/systemd/system/multi-user.target.wants/libvirtd.service → /usr/lib/systemd/system/libvirtd.service.
...output omitted...</pre>
</div>
</div>
</li>
<li>
<p>Refresh the web page (web console) in Firefox browser to reflect the changes.</p>
<div class="literalblock">
<div class="content">
<pre>Note: The Virtual Machines option on the sidebar is visible on servera and serverb because the cockpit-machines package is installed on both servera and serverb.
This installation was done when you ran the lab start migration-cockpit script at the beginning of this exercise.
You do not see the Virtual Machines option on the workstation web console as this package is not installed on it.</pre>
</div>
</div>
</li>
<li>
<p>Navigate to <strong>Virtual Machines → Storage pools</strong>. Click <strong>Create storage pool</strong>.
&#8230;&#8203;Enter the details as given in the following table:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">migration-test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network file system</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path	/mnt/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">workstation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path	/mnt</p></td>
</tr>
</tbody>
</table>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>Click Create</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/3.5.png" alt="3.5">
</div>
</div>
</li>
<li>
<p>Make sure to use the same names as given in the instructions for a successful grading at the end of the exercise.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Activate</strong>. This button starts the inactivate storage pool.</p>
</li>
<li>
<p>Add a storage volume in the <code>migration-test</code> storage pool.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Click the down-arrow key and click the <strong>Storage volumes</strong> tab. Click <strong>Create volume</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/3.7.1.png" alt="3.7.1">
</div>
</div>
</li>
<li>
<p>Enter the name as migration-volume and the size 20 GiB. Click <strong>Create</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/3.7.2.png" alt="3.7.2">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Verify that the storage volume is created. Refer the following screenshot to match it with your UI.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/3.8.png" alt="3.8">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Verify the <code>default network</code> already present on both <code>servera</code> and <code>serverb</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On <code>servera</code>, Click <strong>Virtual machines</strong> breadcrumb.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/4.1.png" alt="4.1">
</div>
</div>
</li>
<li>
<p>Click <strong>1 Network</strong>.</p>
</li>
<li>
<p>Verify that you have a network named <code>default</code>. Click the down-arrow to expand the details and review them. Do not make any changes.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/4.3.png" alt="4.3">
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>You use this network to create the VM in a later step.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Switch to <code>serverb</code>, click <strong>Turn on administrative access</strong>. Enter the password student and click <strong>Authenticate</strong>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Navigate to <strong>Virtual machines → 1 Network</strong> to view the same default network. Verify that the network is in active state. Do not make any other changes.</p>
</li>
<li>
<p>The source and destination must have identical network for the migration to succeed.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set the required SElinux contexts on the shared volume.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the following commands on <code>servera</code> so that SElinux allows the virsh utility to access the shared volume for the VM creation.</p>
<div class="literalblock">
<div class="content">
<pre>[root@servera ~]# semanage fcontext -a -t virt_image_t '/mnt/migration-volume'
[root@servera ~]# restorecon -v '/mnt/migration-volume'
[root@servera ~]# setsebool -P virt_use_nfs 1</pre>
</div>
</div>
</li>
<li>
<p>Run the same commands on <code>serverb</code> as it is the destination host.</p>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# semanage fcontext -a -t virt_image_t '/mnt/migration-volume'
[root@serverb ~]# restorecon -v '/mnt/migration-volume'
[root@serverb ~]# setsebool -P virt_use_nfs 1</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create a virtual machine on <code>servera</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Switch to <code>servera</code> on the RHEL web console UI.</p>
</li>
<li>
<p>Create a virtual machine on <code>servera</code> which is the source host from which you migrate the VM.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Click <strong>Virtual machines</strong> breadcrumb and then click <strong>Create VM</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/6.2.png" alt="6.2">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Enter the details as mentioned in the below table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">test-rhel</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installation type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local install media (ISO image or distro install tree)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installation source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/mnt/rhel-guest-image.qcow2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red Hat Enterprise Linux 8.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">migration-test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Volume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">migration-volume</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 GiB</p></td>
</tr>
</tbody>
</table>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Click <strong>Create</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/6.3.png" alt="6.3">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Verify that VM is in the <code>running</code> state.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/6.4.png" alt="6.4">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Allow the required port number range on the firewall of <code>servera</code> and <code>serverb</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the port range of <code>49152-49215</code> on <code>servera</code> and <code>serverb</code>. Ports <code>49152-49215`</code> are needed by QEMU for transfering the memory and disk migration data.</p>
<div class="literalblock">
<div class="content">
<pre>[root@servera ~]# firewall-cmd --permanent --add-port=49152-49215/tcp
success
[root@servera ~]# firewall-cmd --reload
success</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# firewall-cmd --permanent --add-port=49152-49215/tcp
success
[root@serverb ~]# firewall-cmd --reload
success</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Live-migrate the VM.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use the Migrate option from the dropdown on selecting the three dots of the VM.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/8.1.png" alt="8.1">
</div>
</div>
</li>
<li>
<p>Enter the Destination URI as <code>qemu+ssh://serverb/system</code> and click <strong>Migrate</strong>.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/8.2.png" alt="8.2">
</div>
</div>
</li>
<li>
<p>Verify that you see the following error.</p>
<div class="literalblock">
<div class="content">
<pre>Cannot recv data: Host key verification failed.: Connection reset by peer</pre>
</div>
</div>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/8.3.png" alt="8.3">
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>virsh migrate</code> runs the migration as the <code>root</code> user. For migration to succeed, you copy the public keys of the <code>root</code> user between <code>servera</code> and <code>serverb</code>, remember that this was a prerequisite.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Exchange SSH keys of the root user of <code>servera</code> and <code>serverb</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Generate a SSH key on <code>servera</code>.</p>
<div class="literalblock">
<div class="content">
<pre>[root@servera ~]# ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa
Your public key has been saved in /root/.ssh/id_rsa.pub
The key fingerprint is:
...output omitted...</pre>
</div>
</div>
</li>
<li>
<p>Copy the contents of the public key file at <code>/root/.ssh/id_rsa.pub</code> on <code>servera</code> and add it to <code>/root/.ssh/authorized_keys</code> file in <code>serverb</code>.</p>
</li>
<li>
<p>Generate a SSH key on <code>serverb</code>.</p>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa
Your public key has been saved in /root/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:oGOtnsrVYrbRx8a819sszA/cMp50U++Noz1JzGWPC6M root@serverb.lab.example.com
The key's randomart image is:
...output omitted...</pre>
</div>
</div>
</li>
<li>
<p>Copy the contents of the public key file at <code>/root/.ssh/id_rsa.pub</code> on <code>serverb</code> and add it to <code>/root/.ssh/authorized_keys</code> file in <code>servera</code>.</p>
</li>
<li>
<p>Ensure that you can SSH from <code>servera</code> to <code>serverb</code> as <code>root</code> user and vice versa.</p>
<div class="literalblock">
<div class="content">
<pre>[root@servera ~]# ssh serverb
The authenticity of host 'serverb (172.25.250.11)' can't be established.
ED25519 key fingerprint is SHA256:peUGgfxFNw6Jt6WK4CB2rs+jql1/LhA32M1+8zBawLI.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'serverb' (ED25519) to the list of known hosts.
...output omitted...</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# ssh servera
The authenticity of host 'servera (172.25.250.10)' can't be established.
ED25519 key fingerprint is SHA256:peUGgfxFNw6Jt6WK4CB2rs+jql1/LhA32M1+8zBawLI.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'servera' (ED25519) to the list of known hosts.
...output omitted...
[root@servera ~]#</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Migrate the VM.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>Migrate</strong>. You do not see the VM on <code>servera</code> anymore.</p>
</li>
<li>
<p>Switch to <code>serverb</code> on the web console and verify that the VM is migrated successfully.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Refresh the web page if VM is not seen on serverb after migration. The VM should be in Running state.</p>
<div class="imageblock center text-center">
<div class="content">
<img src="_images/10.2.png" alt="10.2">
</div>
</div>
</li>
<li>
<p>Alternatively, verify with the <code>virsh list</code> command on <code>serverb</code> as the <code>root</code> user.</p>
<div class="literalblock">
<div class="content">
<pre>[root@serverb ~]# virsh list
 Id   Name        State
---------------------------
 1    test-rhel   running</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Verify your work.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the following command on the workstation machine as the student user to verify your work.</p>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ lab grade migration-cockpit
 Grading lab.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>SUCCESS Checking lab systems
SUCCESS Verifying that the VM with name 'test-rhel' exists on serverb
SUCCESS Verifying that the test-rhel VM migrated from servera to serverb</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Overall lab grade: PASS</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Finish</strong></p>
</div>
<div class="paragraph">
<p>On the <code>workstation</code> machine, use the lab command to complete this exercise. This step is important to ensure that resources from previous exercises do not impact upcoming exercises.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[student@workstation ~]$ lab finish migration-cockpit</pre>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section5.html">What are the considerations for a successful live migration?</a></span>
  <span class="next"><a href="../appendix/appendix.html">Appendix</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
